(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{58:function(e,t,n){e.exports=n(92)},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(29),u=n.n(c),l=n(5),o=n(11),i=n(2),s=n.n(i),m=n(4),f=n(55),p=n(22),d=n(19),b=n.n(d),E="/api/blogs",g=null,v=function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get(E);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,b.a.post(E,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,b.a.put("".concat(E,"/").concat(t.id),t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,b.a.delete("".concat(E,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y={getAll:v,create:h,createComment:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("".concat(E,"/").concat(n.id,"/comments/"),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addLike:O,remove:j,setToken:function(e){g="bearer ".concat(e)}},w=function(){return function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_LIKE":var n=t.data,a=e.find((function(e){return e.id===n})),r=Object(p.a)(Object(p.a)({},a),{},{likes:a.likes+1});return e.map((function(e){return e.id!==n?e:r}));case"REMOVE_BLOG":var c=t.removed;return e.filter((function(e){return e.id!==c}));case"ADD_BLOG":return[].concat(Object(f.a)(e),[t.data]);case"INIT_BLOGS":return t.data;case"ADD_COMMENT":var u=t.id,l=e.find((function(e){return e.id===u})),o=Object(p.a)(Object(p.a)({},l),{},{comments:l.comments.concat(t.data)});return e.map((function(e){return e.id!==u?e:o}))}return e},x={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(e,t,n){function a(e){return new Promise((function(t){return setTimeout(t,e)}))}return function(){var r=Object(m.a)(s.a.mark((function r(c){return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c({type:"SHOW_NOTIFICATION",message:e,kind:t}),n*=1e3,r.next=4,a(n);case 4:c({type:"HIDE_NOTIFICATION",message:e});case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,message:null,kind:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_NOTIFICATION":return{show:!0,message:t.message,kind:t.kind};case"HIDE_NOTIFICATION":return{show:!1,message:null,kind:null};default:return e}},N=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.login(e);case 3:a=t.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),n({type:"LOGIN_USER",data:a}),y.setToken(a.token),n(S("Welcome ".concat(a.name),"success",3.8)),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0),n(S("Error: Wrong username or password","error",3.8));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":case"LOGIN_USER":case"LOGOUT_USER":return t.data;default:return e}},T={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getBlogger:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat("/api/users","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(){return function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data}return e},L=n(8),B=n(6),D=function(e){var t=e.user,n=e.handleLogout;return r.a.createElement("div",null,r.a.createElement(L.b,{style:{padding:"5px"},to:"/"},"home"),r.a.createElement(L.b,{style:{padding:"5px"},to:"/users"},"users"),t?r.a.createElement("p",null,t.name," logged in ",r.a.createElement("button",{onClick:n},"Logout")):null)},U=(n(88),function(){var e=Object(l.c)((function(e){return e.notification}));return!1===e.message?null:r.a.createElement("div",{className:"success"===e.kind?"success-message":"error"===e.kind?"error-message":null},e.message)}),R=(n(89),function(e){var t=e.loginHandler,n=Object(a.useState)(""),c=Object(o.a)(n,2),u=c[0],l=c[1],i=Object(a.useState)(""),s=Object(o.a)(i,2),m=s[0],f=s[1],p=function(e){"username-input"===e.target.name?l(e.target.value):f(e.target.value)};return r.a.createElement("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),t({username:u,password:m})}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username-input"},"Username:"),r.a.createElement("input",{className:"login-input",id:"username-input",type:"text",value:u,name:"username-input",onChange:p})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password-input"},"Password:"),r.a.createElement("input",{className:"login-input",id:"password-input",type:"password",value:m,name:"password-input",onChange:p})),r.a.createElement("button",{type:"submit",disabled:!u.length||!m.length},"login"))}),F=function(){var e=Object(l.b)(),t=function(){var t=Object(m.a)(s.a.mark((function t(n){var a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.username,r=n.password,e(N({username:a,password:r}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h2",null,"Blog App"),r.a.createElement("h3",null,"Log into application"),r.a.createElement(R,{loginHandler:t}))},G=(n(90),function(e){var t=e.createBlog,n=Object(a.useState)(""),c=Object(o.a)(n,2),u=c[0],l=c[1],i=Object(a.useState)(""),s=Object(o.a)(i,2),m=s[0],f=s[1],p=Object(a.useState)(""),d=Object(o.a)(p,2),b=d[0],E=d[1],g=function(e){var t=e.target,n=t.name,a=t.value;"title"===n?l(a):"author"===n?f(a):E(a)};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:u,author:m,url:b}),l(""),f(""),E("")},className:"blog-form"},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"title"},"Title:"),r.a.createElement("input",{name:"title",value:u,onChange:g})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"author"},"Author:"),r.a.createElement("input",{name:"author",value:m,onChange:g})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"url"},"URL:"),r.a.createElement("input",{name:"url",value:b,onChange:g})),r.a.createElement("button",{type:"submit"},"Add Blog"))}),H=(n(91),r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(o.a)(n,2),u=c[0],l=c[1],i={display:u?"none":""},s={display:u?"":"none"},m=function(){l(!u)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",{className:"togglable"},r.a.createElement("div",{style:i},r.a.createElement("button",{onClick:m},e.buttonLabel)),r.a.createElement("div",{style:s},e.children,r.a.createElement("button",{onClick:m},"cancel")))})));H.displayName="Togglable";var M=H,W=n(105),J=n(106),V=n(107),z=n(108),K=n(109),P=n(110),q=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.blogs})),n=Object(l.c)((function(e){return e.user})),c=Object(a.useRef)();return r.a.createElement("div",null,r.a.createElement("h2",null,"Blog App"),r.a.createElement("h3",null,"blogs"),r.a.createElement(M,{buttonLabel:"new-blog",ref:c},r.a.createElement(G,{createBlog:function(t){try{e(function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.create(e);case 2:(r=n.sent).user=t,a({type:"ADD_BLOG",data:r});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n)),e(S("A new blog ".concat(t.title," by ").concat(t.author," added"),"success",3.8)),c.current.toggleVisibility()}catch(a){console.log(a),e(S("Error adding a new blog","error",3.8))}}})),r.a.createElement(W.a,{component:J.a},r.a.createElement(V.a,null,r.a.createElement(z.a,null,t.sort((function(e,t){return t.likes-e.likes})).map((function(e){return r.a.createElement(K.a,{key:e.id},r.a.createElement(P.a,null,r.a.createElement(L.b,{to:"/blogs/".concat(e.id)},e.title)),r.a.createElement(P.a,null,e.author))}))))))},Q=function(){var e=Object(l.c)((function(e){return e.users})),t=Object(l.b)();return Object(a.useEffect)((function(){t(C())}),[t]),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h2",null,"Blog App"),r.a.createElement("h3",null,"Users"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Blogs created")),e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(L.b,{style:{padding:"5px"},to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,e.blogs.length))}))))))},X=function(e){var t=e.user,n=Object(a.useState)(!1),c=Object(o.a)(n,2),u=c[0],i=c[1],f=Object(a.useState)(""),d=Object(o.a)(f,2),b=d[0],E=d[1],g=Object(B.g)(),v=Object(B.h)().id,h=Object(l.c)((function(e){return e.blogs})),O=Object(l.b)();Object(a.useEffect)((function(){console.log("running - blogs effect"),h.length||O(w())}),[O,h.length]);var j=function(e){var t=h.find((function(t){return t.id===e})),n=Object(p.a)(Object(p.a)({},t),{},{likes:t.likes+1});try{O(function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.addLike(e);case 2:a=t.sent,n({type:"ADD_LIKE",data:a.id});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(n))}catch(a){console.log(a)}},k=function(e){var t=h.find((function(t){return t.id===e}));try{O(function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,y.remove(e.id);case 3:r=t.sent,n({type:"REMOVE_BLOG",data:r,removed:a});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}catch(n){console.log(n)}},x=h.find((function(e){return e.id===v}));return r.a.createElement("div",null,u?r.a.createElement("div",{className:"remove-confirmation"},r.a.createElement("div",{className:"remove-confirmation-dialog"},r.a.createElement("p",null,"Do you really want to remove ",x.title," by ",x.author,"?"),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return i(!1)}},"Cancel"),r.a.createElement("button",{onClick:function(){return function(e){setTimeout((function(){i(!1)}),500),k(e),g.push("/")}(x.id)}},"Remove")))):null,x?r.a.createElement("div",null,r.a.createElement("h3",null,"Blog app"),r.a.createElement("h2",null,x.title," by ",x.author),r.a.createElement("div",null,r.a.createElement("a",{href:x.url,target:"_blank",rel:"noopener noreferrer"},"Read it!"),r.a.createElement("p",{className:"blog-item",id:"likes"},"likes ",x.likes," ",r.a.createElement("button",{onClick:function(){return j(x.id)}},"like")),r.a.createElement("p",{className:"blog-item"},x.user&&x.user.name?r.a.createElement(L.b,{to:"/users/".concat(x.user.id)},x.user.name):"anonymous"),t&&x.user&&t.name===x.user.name?r.a.createElement("button",{onClick:function(){return i(!0)}},"remove"):null),r.a.createElement("div",null,r.a.createElement("h4",null,"Comments"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),O(function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.createComment(e,t);case 2:r=n.sent,a({type:"ADD_COMMENT",data:r,id:t.id});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}({comment:b},x)),E("")},className:"blog-form"},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"comment"},"Comment:"),r.a.createElement("input",{name:"comment",value:b,onChange:function(e){var t=e.target.value;E(t)}}),r.a.createElement("button",{type:"submit"},"Add Comment"))),x.comments&&x.comments.length?r.a.createElement("ul",null,x.comments.map((function(e){return r.a.createElement("li",{key:e.id},e.comment)}))):null)):null)},Y=function(){var e=Object(B.h)().id,t=Object(l.c)((function(e){return e.users})),n=Object(l.b)();Object(a.useEffect)((function(){t.length||n(C())}),[n,t.length]);var c=t.find((function(t){return t.id===e}));return r.a.createElement("div",null,c&&c.blogs?r.a.createElement("div",null,r.a.createElement("h2",null,c.name),r.a.createElement("h4",null,"Added blogs"),r.a.createElement("ul",null,c.blogs.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(L.b,{to:"/blogs/".concat(e.id)},e.title))})))):r.a.createElement("div",null,r.a.createElement("p",null,"Loading...")))},Z=n(111),$=function(){var e=Object(a.useState)(!0),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(l.c)((function(e){return e.user})),i=Object(l.c)((function(e){return e.users})),s=Object(l.b)();Object(a.useEffect)((function(){s(function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);return y.setToken(t.token),function(e){e({type:"SET_USER",data:t})}}return function(e){e({type:"SET_USER",data:null})}}()),s(w()),s(C()),c(!1)}),[s]);return r.a.createElement(L.a,null,r.a.createElement(Z.a,null,r.a.createElement(U,null),r.a.createElement(D,{user:u,handleLogout:function(){s(function(e){return function(t){try{window.localStorage.getItem("loggedBlogAppUser")&&window.localStorage.removeItem("loggedBlogAppUser"),t(S("Bye bye ".concat(e.name),"success",3.8)),t({type:"LOGOUT_USER",data:null})}catch(n){console.log(n)}}}(u))}}),n?r.a.createElement("div",null,"Loading..."):r.a.createElement(B.d,null,r.a.createElement(B.b,{path:"/users/:id",render:function(){return u?r.a.createElement(Y,{users:i}):r.a.createElement(B.a,{to:"/login"})}}),r.a.createElement(B.b,{path:"/users",render:function(){return u?r.a.createElement(Q,{user:u}):r.a.createElement(B.a,{to:"/login"})}}),r.a.createElement(B.b,{path:"/blogs/:id",render:function(){return u?r.a.createElement(X,{user:u}):r.a.createElement(B.a,{to:"/login"})}}),r.a.createElement(B.b,{path:"/login",render:function(){return u?r.a.createElement(B.a,{to:"/"}):r.a.createElement(F,null)}}),r.a.createElement(B.b,{path:"/",render:function(){return null===u?r.a.createElement(B.a,{to:"/login"}):r.a.createElement(q,null)}}))))},ee=n(24),te=n(53),ne=n(54),ae=Object(ee.combineReducers)({user:A,users:_,blogs:k,notification:I}),re=Object(ee.createStore)(ae,Object(ne.composeWithDevTools)(Object(ee.applyMiddleware)(te.a)));u.a.render(r.a.createElement(l.a,{store:re},r.a.createElement($,null)),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.4f86558e.chunk.js.map